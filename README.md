# _Desktop Monitor_

(See the README.md file in the upper level 'examples' directory for more information about examples.)

## How to config
LVGL and TinyUSB settings can be edited from sdkconfig.

LCD ping configurations are listed in the [display_config.h](main/display_config.h).


## How to flash
Using UART with ESP32S3 built in JTAG

## Folder contents

The project **Desktop monitor** contains one source file in C language [main.c](main/main.c). The file is located in folder [main](main).

ESP-IDF projects are built using CMake. The project build configuration is contained in `CMakeLists.txt`
files that provide set of directives and instructions describing the project's source files and targets
(executable, library, or both). 

Below is short explanation of remaining files in the project folder.

```
├── lvgl_proj                  // LVGL porject
├── CMakeLists.txt
├── main
│   ├── CMakeLists.txt
│   ├── custom
│   └── (custom funtions 
│        generated by the Gui guider)
│   ├── generated
│       └── (evnets/ widages/ uisetup 
│            generated by the Gui guider)
│   ├── import
│   └── (image/ font
│        generated by the Gui guider)
│   ├── app_main.h             // Global variables
│   ├── main.c
│   ├── display_config.h       // LCD pins
│   ├── display_driver.h
│   ├── display_driver.c
│   ├── tinyusb_cdc.h
│   ├── tinyusb_cdc.c
│   ├── lv_conf.h              // Not used for now
│   ├── metrics.h
│   ├── metrics.c              // Package decoding and sending
│   └── managed_components
│       └── (components from ESP Component Registry)
├── partition.csv              // Flash partition table
└── README.md                  // This is the file you are currently reading
```

## Metrics structure

Metrics are delivered as an 18-byte little-endian packet that matches `pc_metrics_packet_t` in
`main/metrics.h`. The fields appear in the following order:

| Offset (bytes) | Field                      | Type      | Units / Notes                      |
| -------------- | -------------------------- | --------- | ---------------------------------- |
| 0              | `magic`                    | `uint8`   | Must be `0xA5`                     |
| 1              | `version`                  | `uint8`   | Currently `0x01`                   |
| 2-3            | `cpu_usage_tenths`         | `uint16`  | CPU utilisation in 0.1% steps    |
| 4-5            | `cpu_temp_tenths`          | `int16`   | CPU temperature in 0.1 °C steps   |
| 6-7            | `cpu_freq_mhz`             | `uint16`  | CPU frequency in MHz              |
| 8-9            | `gpu_usage_tenths`         | `uint16`  | GPU utilisation in 0.1% steps    |
| 10-11          | `gpu_temp_tenths`          | `int16`   | GPU temperature in 0.1 °C steps   |
| 12-13          | `gpu_freq_mhz`             | `uint16`  | GPU frequency in MHz              |
| 14-15          | `gram_usage_tenths`        | `uint16`  | Graphics RAM usage in 0.1% steps |
| 16-17          | `ram_usage_tenths`         | `uint16`  | System RAM usage in 0.1% steps   |

Example packet (`0xA5 0x01 0x78 0x00 0x2D 0x01 0xB0 0x04 0x0A 0x00 0x96 0x00 0xD0 0x07 0x64 0x00 0xB1 0x00`) decodes to:

- CPU: 12.0% @ 1.20 GHz, 29.3 °C  
- GPU: 1.0% @ 2.00 GHz, 15.0 °C  
- Graphics RAM usage: 10.0%  
- System RAM usage: 17.7%
